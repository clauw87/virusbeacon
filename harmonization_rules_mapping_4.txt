# harmonization_rules_mapping_4

NOTE: Now that we are getting Nanopore data we should start showing the two objects run_platform and run_platform_model. Note that before we were showing only run_platform_model and the column name in Beacon UI is now PLATFORM, so we now need to change that column name to PLATFORM MODEL and add the new column PLATFORM to the UI table


## RUN

1. run_platform

* **XML tags**
names(xml$EXPERIMENT_PACKAGE_SET$EXPERIMENT_PACKAGE$EXPERIMENT$PLATFORM)

* **Valid values**
“ILLUMINA”
"OXFORD_NANOPORE"


2. run_platform_model 

* **XML tags**
xml$EXPERIMENT_PACKAGE_SET$EXPERIMENT_PACKAGE$EXPERIMENT$PLATFORM$ILLUMINA$INSTRUMENT_MODEL[[1]]

* **Valid values**
"Illumina MiSeq"        
"Illumina HiSeq 2500"  
"NextSeq 500"           
"NextSeq 550"          
"Illumina iSeq 100"     
"Illumina MiniSeq"     
"Illumina NovaSeq 6000"
"GridION"

* ** Values to show ** 
"MiSeq"        
"HiSeq 2500"  
"NextSeq 500"           
"NextSeq 550"          
“iSeq 100"     
"MiniSeq"     
"NovaSeq 6000"
"GridION"

* **Values to fix**
(in general, remove the string Illumina an the space afterwards from all values)
"Illumina MiSeq"  ->  "MiSeq"  
"Illumina HiSeq 2500"  ->  "HiSeq 2500"  
"Illumina iSeq 100"     ->  "iSeq 100"  
"Illumina MiniSeq"   ->     "MiniSeq"  
"Illumina NovaSeq 6000" -> "NovaSeq 6000"


## BIOSAMPLE 

1. biosample_type
* **XML tags**
  * tissue 
  * env_medium
  * isolation_source
  * host_tissue_sampled

* **Valid values**
  * "Human BALF sample", 
  * "Bronchoalveolar lavage fluid", 
  * "bronchoalveolar lavage fluid(BALF)", 
  * "Oro-pharyngeal swab", 
  * "oropharyngeal swab",  
  * "nasopharynx",  
  * "swab" 
  * "respiratory nasopharyngeal sample" 
  * "Nasopharyngeal/throat swab"
  * "Combined nasopharyngeal and oropharyngeal swab" 
  * "oral swab; nasal swab; tracheal wash" 
  * "Diagnostic Swab" 
  * "tracheal swab" 
  * "bronchoalveolar lavage"
  * "sputum"
  * "oralpharyngeal" 
  * "nasal swab"  
  * "oropharynx"
  * "Stool"


  Rest of values in the column change to NULL (leave empty)

NOTE: now there are samples that are mixes, e.g "oral swab; nasal swab; tracheal wash", we should label those as “mix” and also as their component sources (“oro/naso-pharyngeal swab”, ”tracheal swab/wash“). That’s why they appear duplicated in more than one values to harmonize set.

* **Values to show** (these ones will be the values shown in Beacon UI)
  * “bronchoalveolar lavage fluid" 
  * “naso/oro-pharyngeal swab”
  * “pharyngeal swab”
  * ”tracheal swab/wash“ 
  * ”sputum”
  * ”feces”
  * ~~“mix”~~ "oropharingeal swab; nasopharyngeal swab; traqueal whash" 

* **Values to harmonize**

  * bronchoalveolar lavage fluid values:
    * "Bronchoalveolar lavage fluid", 
    * "bronchoalveolar lavage fluid(BALF)”, 
    * "Human BALF sample"
    * "bronchoalveolar lavage"

    These values would be shown as “bronchoalveolar lavage fluid"  

  * Naso/ro-pharyngeal swab values:
    * “Oro-pharyngeal swab", 
    * "oropharyngeal swab” 
    * "Combined nasopharyngeal and oropharyngeal swab"
    * "oral swab; nasal swab; tracheal wash" 
    * "oralpharyngeal"
    * "oropharynx"
    * “nasopharynx" 
    * "respiratory nasopharyngeal sample"
    * "Nasopharyngeal/throat swab"
    * "Combined nasopharyngeal and oropharyngeal swab"
    * "oral swab; nasal swab; tracheal wash"  
    * "nasal swab"  
    * “swab”
    * "Diagnostic Swab" 
    * "Combined nasopharyngeal and oropharyngeal swab"

    These values would be shown as “pharyngeal swab” 


  * tracheal swab/wash values: 
    * ”tracheal swab" 
    * "oral swab; nasal swab; tracheal wash" 


    These values would be shown as “tracheal swab/wash” 


  * sputum values 
    * “sputum”   

    These values would be shown as “sputum” 


  * feces values 
    * “Stool”   
    These values would be shown as “feces” 


  * mix 
    * "oral swab; nasal swab; tracheal wash"   



2. collection_date

* **XML tags**
  * collection_date 

* **Valid values**
  All values are dates, but come in different formats e.g "02-Jan-2020”, "2020-02-14" , "2020”, "2020-03”. 

* **Values to show** (these ones we’ll get after harmonization)
  We want to homogenize to ISO 8601 international standard, i.e “%Y-%m-%d” 

* **Values to harmonize**
  * ”%d-%B-%Y” 
  * “%Y-%m” 
  * %Y”

  Harmonize all to “%Y-%m-%d”

  * “%Y-%m”, %Y”, not really necessary, only harmonize if there is a standard way of replacing missing month and day- I think usually they do replacement of missing month/date by “01”

  * “%d-%B-%Y” values 
    * "01-Mar-2020"
    * "19-MAR-2020"

    convert to “%Y-%m-%d” to get:
    * “2020-03-01”
    * "2020-03-19"

* **Value to fix**
  “2019-01-19” ->  "2020-01-19" 
  "missing"  -> NULL
  "not applicable"  -> NULL



## HOST/INDIVIDUAL

1. host_taxon_id 
 
* **XML tags**
  * host
  * env_broad_scale
  * host_description
  * host_taxid

* **Valid values**
  * ”Homo sapiens”, 
  * ”Human”, 
  * "Isolated from clinical sample from the first case of nCov in US from Washington State”)  
  * "9606"

  Convert all these to ”Homo sapiens” an map to “9606”.
  Rest of values in the column change to NULL (leave empty).

2. geo_origin

* **XML tags**
  * geo_loc_name
  * country
 (combined) * `geographic location (country and/or sea)`
 (combined) * `geographic location (region and locality)`  

(The last two are pairs country-region shown in different tags, so we could extract them in just one value as `geographic location (country and/or sea)`: `geographic location (region and locality)` to match the others i.e “United Kingdom: Scotland”)

* **Valid values**
   All are geo doc values, but different formats, e.g "USA:WI:Madison”, "USA: CA, San Diego County”.
     

* **Values to fix/ harmonize**

"China:Wuhan" ->  "China: Hubei: Wuhan”
"China: Wuhan" ->  "China: Hubei: Wuhan”
"USA:WA" -> "USA: Washington" 
"USA: WA"  -> "USA: Washington" 
"USA: Seattle, WA"  -> "USA: Washington: Seattle“
"USA:WI:Madison" -> "USA: Wisconsin: Madison"
"USA:WI,Madison" -> "USA: Wisconsin: Madison"
"USA:Wisconsin" -> "USA: Wisconsin” 
"USA: Racine, Wisconsin" -> "USA: Wisconsin: Racine”
"USA: Milwaukee, Wisconsin"    -> "USA: Wisconsin: Milwaukee”   
"USA: Port Washi, Wisconsin"    -> "USA: Wisconsin: Racine”  
"USA: Thiensvill, Wisconsin"    -> "USA: Wisconsin: Port Washi” 
"USA: Grafton, Wisconsin"    -> "USA: Wisconsin: Grafton”     
"USA: Mequon, Wisconsin"      -> "USA: Wisconsin: Mequon”   
"USA: Whitefish, Wisconsin"    -> "USA: Wisconsin: Whitefish”   
"USA: Pewaukee, Wisconsin"     -> "USA: Wisconsin: Pewaukee”  
"USA: Cudahy, Wisconsin"      -> "USA: Wisconsin: Cudahy”    
"USA: Glendale, Wisconsin"       -> "USA: Wisconsin: Glendale”
"USA: Greenfield, Wisconsin"     -> "USA: Wisconsin: Greenfield” 
"USA: South Milwaukee, Wisconsin"  -> "USA: Wisconsin: South Milwaukee”
"USA: Elm Grove, Wisconsin"     -> "USA: Wisconsin: Elm Grove”  
"USA: Franklin, Wisconsin"       -> "USA: Wisconsin: Franklin”
"USA: Brookfield, Wisconsin"      -> "USA: Wisconsin: Brookfield”
"USA: Campbellsp, Wisconsin"     -> "USA: Wisconsin: Campbellsp”
"USA: Green Field, Wisconsin"     -> "USA: Wisconsin: Green Field”
"USA: Oak Creek, Wisconsin"      -> "USA: Wisconsin: Oak Creek”
"USA: Jackson, Wisconsin"         -> "USA: Wisconsin: Jackson”
"USA: Wauwatosa, Wisconsin"      -> "USA: Wisconsin: Wauwatosa”
"USA: New Berlin, Wisconsin"  -> "USA: Wisconsin: New Berlin” 
"USA: Wauwatosa, Wisconsin"  -> "USA: Wisconsin: Wauwatosa” 
"USA: CA, San Diego County"  -> "USA: California: San Diego County”
"USA:Virginia" -> "USA: Virginia"
"Australia: Melbourne, Victoria" -> "Australia: Victoria: Melbourne” 
"Cambodia:Sihanoukville" -> "Cambodia: Sihanoukville" 



* **Values to show**  (values after harmonization, as they will be shown in Beacon UI)
  * "China: Hubei: Wuhan”
  * "USA: Washington" 
  * "USA: Wisconsin: Madison"
  * "Nepal: Kathmandu"  
  * "USA: Washington: Seattle“
  * "USA: Washington" 
  * "USA"
  * "USA: California: San Diego County”
  * "USA: California"                
  * "USA: Iowa"                       
  * "USA: Massachusetts"                     
  * "USA: South Carolina"            
  * "USA: New Jersey"                 
  * "USA: New York"                  
  * "USA: Washington"
  * "USA: New York" 
  * "Australia: Victoria" 
  * "Australia: Victoria: Melbourne” 
  * "Australia: Northern Territory" 
  * "Peru: Lima" 
  * "Cambodia: Sihanoukville" 
  * "Malaysia: Kuala Lumpur"
  * "Malaysia"
  * "South Africa: KwaZulu-Natal"
  * "India: Rajkot"
  * "Israel"
  * "Germany: Dusseldorf"
  * "Germany: Heinsberg"
  * “United Kingdom: England”
  * “United Kingdom: Scotland”
  * "USA: Wisconsin: Madison” 
  * "USA: Wisconsin” 
  * "USA: Wisconsin: Racine”
  * "USA: Wisconsin: Milwaukee”   
  * "USA: Wisconsin: Racine”  
  * "USA: Wisconsin: Port Washi” 
  * "USA: Wisconsin: Grafton”     
  * "USA: Wisconsin: Mequon”   
  * "USA: Wisconsin: Whitefish”   
  * "USA: Wisconsin: Pewaukee”  
  * "USA: Wisconsin: Cudahy”    
  * "USA: Wisconsin: Glendale”
  * "USA: Wisconsin: Greenfield” 
  * "USA: Wisconsin: South Milwaukee”
  * "USA: Wisconsin: Elm Grove”  
  * "USA: Wisconsin: Franklin”
  * "USA: Wisconsin: Brookfield”
  * "USA: Wisconsin: Campbellsp”
  * "USA: Wisconsin: Green Field”
  * "USA: Wisconsin: Oak Creek”
  * "USA: Wisconsin: Jackson”
  * "USA: Wisconsin: Wauwatosa”
  * "USA: Wisconsin: New Berlin” 
  * "USA: Wisconsin: Wauwatosa” 



3. host_age

* **XML tags**
  * age
  * host_age

* **Values to fix** 
“missing” -> NULL
“4 years” -> 4 
“35 y” -> 35
“5 y” -> 5

4. host_disease

* **XML tags**
  * host_disease

* **Values to show**  (values after harmonization, as they will be shown in Beacon UI)

  * "nCoV pneumonia"                                 
  * "COVID-19"                                                                                
  * "severe acute respiratory syndrome"   
  * "respiratory infection"           

  This values will be shown with no harmonization. But rest of values in the column change to NULL (leave empty)

4. host_sex

* **XML tags**
  * host_sex

* **Values to show**  (values after harmonization, as they will be shown in Beacon UI)

  * “female”                                 
  * “male” 

* **Values to harmonize/fix**
Female -> “female” 
Male -> “male” 

 Rest of values in the column change to NULL (leave empty)

## VIRUS

1. taxon_id

* **XML tags**
  * EXPERIMENT_PACKAGE_SET> EXPERIMENT_PACKAGE> SAMPLE> SAMPLE_NAME> TAXON_ID[[1]]
    
* **Valid values**
  All values are taxon ids, only 3 need harmonization

* **Values to show** (these ones we’ll get after harmonization)
  
  “2697049” (“Severe acute respiratory syndrome coronavirus 2”) 436/439 xml have it  is what should appear here for all samples.
  
  NOTE: In title and abstract they all described that they attempted sequencing SARS-CoV2, so, despite the taxon they applied they only used novel reads (not mapped to human, so we could convert all values to “2697049” for the sake of taxon\_id as filtering)

* **Values to harmonize/fix**
  * "9606"  (Homo sapiens) - 2 xml have it
  * "433733” ("human lung metagenome" ) - 1 xml have it

  Change all to “2697049”
